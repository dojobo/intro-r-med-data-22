<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-99.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dominic Bordelon, Research Data Librarian, University of Pittsburgh Library System">
<meta name="dcterms.date" content="2022-06-21">

<title>Session 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="session_2-filled_files/libs/clipboard/clipboard.min.js"></script>
<script src="session_2-filled_files/libs/quarto-html/quarto.js"></script>
<script src="session_2-filled_files/libs/quarto-html/popper.min.js"></script>
<script src="session_2-filled_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="session_2-filled_files/libs/quarto-html/anchor.min.js"></script>
<link href="session_2-filled_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="session_2-filled_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="session_2-filled_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="session_2-filled_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="session_2-filled_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Session 2</h1>
<p class="subtitle lead">Data wrangling</p>
</div>





<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dominic Bordelon, Research Data Librarian, University of Pittsburgh Library System </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 21, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="session-2-data-wrangling" class="level1">
<h1>Session 2: Data wrangling</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/data_cowboy.png" class="img-fluid figure-img" alt="A green fuzzy monster in a cowboy hat and mustache, lassoing a group of unruly data tables while riding a blue fuzzy monster."></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ol type="1">
<li>Pipes in R</li>
<li>Selecting columns; filtering and sorting rows</li>
<li>Creating new columns</li>
<li>Grouping and summarizing</li>
<li>Random sampling of rows</li>
<li>Data cleaning: tidy data, missing values</li>
<li>Exporting data from R</li>
</ol>
<p>Most of what we are doing today is in the {dplyr} and {tidyr} packages. These PDF cheat sheets are a handy reference: <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf">dplyr</a>, <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/tidyr.pdf">tidyr</a></p>
</section>
<section id="pipes-in-r" class="level2">
<h2 class="anchored" data-anchor-id="pipes-in-r">Pipes in R</h2>
<p>The <strong>pipe</strong> is an operator, written <strong><code>%&gt;%</code></strong>, that enables us to pass the output from one function, into another function. Consider:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_values <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:-</span><span class="dv">10</span>    <span class="co"># -1 to -10, as a vector</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>my_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  -1  -2  -3  -4  -5  -6  -7  -8  -9 -10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># below i take the absolute value, then the square root, </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># then round to 3 decimal places, then calculate the mean</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">abs</span>(my_values)), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.2467</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with a pipe, this can be rewritten as:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>my_values <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.2467</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># more readable, right?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The keyboard shortcut for <code>%&gt;%</code> is <strong>Ctrl+Shift+M</strong> (Windows) or <strong>Cmd+Shift+M</strong> (macOS).</p>
<p>You might also see a newer notation for the pipe, <code>|&gt;</code>. It works the same way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>my_values <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.2467</code></pre>
</div>
</div>
<p>We’ll be using the first pipe, also called “the magrittr pipe” after the package it comes from.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/magrittr.png" class="img-fluid figure-img" alt="magrittr logo"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">magrittr logo</figcaption><p></p>
</figure>
</div>
</section>
<section id="looking-at-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="looking-at-data-frames">Looking at data frames</h2>
<p><code>print()</code>, str()<code>,</code>View()<code>,</code>summary()`</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/genoData.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 59874 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (13): patientID, age, htn, treat, smoking, race, t2d, gender, rs10757278...
dbl  (4): numAge, bmi, tchol, sbp

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59,874 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 N     N     N       White N     F          37    22   175   113
 2 HHUID0… 20-40 N     N     N       White N     F          32    25   156   116
 3 HHUID0… 40-55 Y     N     N       White N     F          40    23   243   193
 4 HHUID0… 20-40 Y     Y     N       White N     F          32    23   157   183
 5 HHUID0… 20-40 N     N     N       White N     M          29    17   156   131
 6 HHUID0… 40-55 Y     N     N       White N     F          40    25   193   164
 7 HHUID0… 40-55 N     N     N       Asia… Y     M          43    25   196   120
 8 HHUID0… 20-40 Y     Y     N       White N     F          20    17   238   188
 9 HHUID0… 20-40 N     N     N       Asia… N     F          37    21   195   113
10 HHUID0… 20-40 N     N     N       White N     M          24    23   240   125
# … with 59,864 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>Get a histogram of a variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cvdrisk, <span class="fu">aes</span>(sbp)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="session_2-filled_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="selecting-columns-filtering-and-sorting-rows" class="level2">
<h2 class="anchored" data-anchor-id="selecting-columns-filtering-and-sorting-rows">Selecting columns; filtering and sorting rows</h2>
<section id="select-which-columns" class="level3">
<h3 class="anchored" data-anchor-id="select-which-columns"><code>select()</code>: which columns?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cvdrisk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59,874 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 N     N     N       White N     F          37    22   175   113
 2 HHUID0… 20-40 N     N     N       White N     F          32    25   156   116
 3 HHUID0… 40-55 Y     N     N       White N     F          40    23   243   193
 4 HHUID0… 20-40 Y     Y     N       White N     F          32    23   157   183
 5 HHUID0… 20-40 N     N     N       White N     M          29    17   156   131
 6 HHUID0… 40-55 Y     N     N       White N     F          40    25   193   164
 7 HHUID0… 40-55 N     N     N       Asia… Y     M          43    25   196   120
 8 HHUID0… 20-40 Y     Y     N       White N     F          20    17   238   188
 9 HHUID0… 20-40 N     N     N       Asia… N     F          37    21   195   113
10 HHUID0… 20-40 N     N     N       White N     M          24    23   240   125
# … with 59,864 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cvdrisk)    <span class="co"># 17 variables (columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spec_tbl_df [59,874 × 17] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ patientID : chr [1:59874] "HHUID00520605" "HHUID00576813" "HHUID00957042" "HHUID00226899" ...
 $ age       : chr [1:59874] "20-40" "20-40" "40-55" "20-40" ...
 $ htn       : chr [1:59874] "N" "N" "Y" "Y" ...
 $ treat     : chr [1:59874] "N" "N" "N" "Y" ...
 $ smoking   : chr [1:59874] "N" "N" "N" "N" ...
 $ race      : chr [1:59874] "White" "White" "White" "White" ...
 $ t2d       : chr [1:59874] "N" "N" "N" "N" ...
 $ gender    : chr [1:59874] "F" "F" "F" "F" ...
 $ numAge    : num [1:59874] 37 32 40 32 29 40 43 20 37 24 ...
 $ bmi       : num [1:59874] 22 25 23 23 17 25 25 17 21 23 ...
 $ tchol     : num [1:59874] 175 156 243 157 156 193 196 238 195 240 ...
 $ sbp       : num [1:59874] 113 116 193 183 131 164 120 188 113 125 ...
 $ rs10757278: chr [1:59874] "AA" "AA" "AA" "AA" ...
 $ rs1333049 : chr [1:59874] "CC" "CC" "CC" "CC" ...
 $ rs4665058 : chr [1:59874] "CC" "CC" "AA" "CC" ...
 $ rs8055236 : chr [1:59874] "TT" "TT" "TT" "GG" ...
 $ cvd       : chr [1:59874] "N" "N" "N" "N" ...
 - attr(*, "spec")=
  .. cols(
  ..   patientID = col_character(),
  ..   age = col_character(),
  ..   htn = col_character(),
  ..   treat = col_character(),
  ..   smoking = col_character(),
  ..   race = col_character(),
  ..   t2d = col_character(),
  ..   gender = col_character(),
  ..   numAge = col_double(),
  ..   bmi = col_double(),
  ..   tchol = col_double(),
  ..   sbp = col_double(),
  ..   rs10757278 = col_character(),
  ..   rs1333049 = col_character(),
  ..   rs4665058 = col_character(),
  ..   rs8055236 = col_character(),
  ..   cvd = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(numAge, gender, bmi, treat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59,874 × 4
   numAge gender   bmi treat
    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
 1     37 F         22 N    
 2     32 F         25 N    
 3     40 F         23 N    
 4     32 F         23 Y    
 5     29 M         17 N    
 6     40 F         25 N    
 7     43 M         25 N    
 8     20 F         17 Y    
 9     37 F         21 N    
10     24 M         23 N    
# … with 59,864 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many columns do we have? how many rows?</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that the column order is also different</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># you can also select using index numbers:</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59,874 × 5
   htn   treat smoking race     t2d  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;
 1 N     N     N       White    N    
 2 N     N     N       White    N    
 3 Y     N     N       White    N    
 4 Y     Y     N       White    N    
 5 N     N     N       White    N    
 6 Y     N     N       White    N    
 7 N     N     N       Asian/PI Y    
 8 Y     Y     N       White    N    
 9 N     N     N       Asian/PI N    
10 N     N     N       White    N    
# … with 59,864 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
</section>
<section id="filter-which-rows" class="level3">
<h3 class="anchored" data-anchor-id="filter-which-rows"><code>filter()</code>: which rows?</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/dplyr_filter.jpg" class="img-fluid figure-img" alt="Cartoon showing three fuzzy monsters either selecting or crossing out rows of a data table. If the type of animal in the table is “otter” and the site is “bay”, a monster is drawing a purple rectangle around the row. If those conditions are not met, another monster is putting a line through the column indicating it will be excluded. Stylized text reads “dplyr::filter() - keep rows that satisfy your conditions.”"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(numAge <span class="sc">==</span> <span class="dv">19</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(patientID, numAge, smoking)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 716 × 3
   patientID     numAge smoking
   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
 1 HHUID00164346     19 N      
 2 HHUID00802705     19 N      
 3 HHUID00782633     19 N      
 4 HHUID00732619     19 N      
 5 HHUID00732812     19 Y      
 6 HHUID00293504     19 N      
 7 HHUID00506980     19 N      
 8 HHUID00944871     19 N      
 9 HHUID00158191     19 N      
10 HHUID00786858     19 N      
# … with 706 more rows
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tchol <span class="sc">&gt;</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,797 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 40-55 Y     N     N       White N     F          40    23   243   193
 2 HHUID0… 20-40 Y     Y     N       White N     F          20    17   238   188
 3 HHUID0… 20-40 N     N     N       White N     M          24    23   240   125
 4 HHUID0… 20-40 Y     Y     N       White N     F          23    24   235   201
 5 HHUID0… 40-55 N     N     N       White N     F          41    22   243   118
 6 HHUID0… 20-40 N     N     N       White N     F          33    33   204   122
 7 HHUID0… 40-55 N     N     N       Blac… N     M          42    21   244   139
 8 HHUID0… 20-40 N     N     N       Blac… N     M          29    24   242   112
 9 HHUID0… 20-40 N     N     N       Blac… N     M          31    23   219   120
10 HHUID0… 20-40 N     N     N       White N     M          30    19   228   128
# … with 15,787 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparisons: &gt; &gt;= &lt; &lt;= == !=</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check multiple values with the %in% operator, and a vector:</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(race <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Black/AfAm"</span>, <span class="st">"AmInd"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,630 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 40-55 N     N     N       Blac… N     M          42    21   244   139
 2 HHUID0… 20-40 N     N     N       AmInd N     F          28    19   165   124
 3 HHUID0… 20-40 N     N     N       Blac… N     M          29    24   242   112
 4 HHUID0… 20-40 N     N     N       Blac… N     M          31    23   219   120
 5 HHUID0… 20-40 N     N     N       Blac… N     F          34    23   243   113
 6 HHUID0… 20-40 N     N     N       Blac… Y     F          31    19   231    99
 7 HHUID0… 20-40 N     N     N       Blac… N     F          27    20   218   120
 8 HHUID0… 40-55 Y     N     N       Blac… N     F          42    23   228   173
 9 HHUID0… 20-40 N     N     N       Blac… N     F          35    24   241   123
10 HHUID0… 20-40 N     N     N       Blac… N     M          30    19   243   109
# … with 3,620 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(race)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 1
  race      
  &lt;chr&gt;     
1 White     
2 Asian/PI  
3 Black/AfAm
4 AmInd     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI is between 25 and 30 (inclusive):</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(bmi, <span class="dv">25</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,428 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 N     N     N       White N     F          32    25   156   116
 2 HHUID0… 40-55 Y     N     N       White N     F          40    25   193   164
 3 HHUID0… 40-55 N     N     N       Asia… Y     M          43    25   196   120
 4 HHUID0… 20-40 N     N     N       Asia… N     F          26    26   160   105
 5 HHUID0… 20-40 N     N     N       White N     F          31    25   194   102
 6 HHUID0… 20-40 N     N     N       White N     F          24    25   159   123
 7 HHUID0… 20-40 N     N     N       White N     F          22    29   156   128
 8 HHUID0… 40-55 Y     N     N       Asia… N     M          43    25   157   177
 9 HHUID0… 40-55 Y     Y     N       White N     M          44    26   233   193
10 HHUID0… 20-40 N     N     Y       White N     F          30    25   160   108
# … with 8,418 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>Multiple conditions can be combined with the symbols <code>&amp;</code> (ampersand, “AND”) and <code>|</code> (vertical pipe, “OR”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(numAge, <span class="dv">19</span>, <span class="dv">24</span>) <span class="sc">&amp;</span> smoking <span class="sc">==</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,412 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 N     N     Y       White N     F          24    35   157   128
 2 HHUID0… 20-40 N     N     Y       White N     M          24    15   198   132
 3 HHUID0… 20-40 Y     Y     Y       White N     M          20    24   243   180
 4 HHUID0… 20-40 N     N     Y       Asia… N     M          24    21   177   107
 5 HHUID0… 20-40 Y     N     Y       White N     M          22    27   159   178
 6 HHUID0… 20-40 Y     Y     Y       White N     F          24    18   160   189
 7 HHUID0… 20-40 N     N     Y       White N     F          21    25   243   122
 8 HHUID0… 20-40 N     N     Y       Asia… Y     M          22    28   156   112
 9 HHUID0… 20-40 N     N     Y       White N     F          21    20   179   122
10 HHUID0… 20-40 N     N     Y       White N     F          24    19   227   117
# … with 1,402 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(numAge, <span class="dv">19</span>, <span class="dv">24</span>) <span class="sc">|</span> smoking <span class="sc">==</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17,417 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 Y     Y     N       White N     F          20    17   238   188
 2 HHUID0… 20-40 N     N     N       White N     M          24    23   240   125
 3 HHUID0… 20-40 Y     Y     N       White N     F          23    24   235   201
 4 HHUID0… 20-40 N     N     Y       White N     F          29    20   164   127
 5 HHUID0… 20-40 N     N     N       White N     F          24    25   159   123
 6 HHUID0… 20-40 N     N     N       White N     F          22    29   156   128
 7 HHUID0… 20-40 Y     N     N       White N     F          24    19   162   188
 8 HHUID0… 20-40 Y     N     Y       Asia… N     F          39    24   172   174
 9 HHUID0… 20-40 N     N     Y       White N     F          40    21   197   112
10 HHUID0… 20-40 N     N     N       Asia… N     M          23    20   193   115
# … with 17,407 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
</section>
<section id="arrange-in-what-order-should-the-rows-appear" class="level3">
<h3 class="anchored" data-anchor-id="arrange-in-what-order-should-the-rows-appear"><code>arrange()</code>: in what order should the rows appear?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort by numAge:</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(bmi, <span class="dv">25</span>, <span class="dv">26</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(numAge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,453 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 0-20  N     N     Y       White N     F          19    25   244   116
 2 HHUID0… 0-20  N     N     N       White N     F          19    25   243   102
 3 HHUID0… 0-20  N     N     N       White N     M          19    25   182   120
 4 HHUID0… 0-20  N     N     N       White N     M          19    25   244   123
 5 HHUID0… 0-20  N     N     N       Asia… N     M          19    25   229   133
 6 HHUID0… 0-20  N     N     N       Asia… N     F          19    25   155   119
 7 HHUID0… 0-20  N     N     N       Asia… N     F          19    25   196   127
 8 HHUID0… 0-20  N     N     N       White N     F          19    25   156   102
 9 HHUID0… 0-20  N     N     N       White N     M          19    25   242   134
10 HHUID0… 0-20  N     N     N       White N     M          19    25   245   137
# … with 4,443 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort by numAge, descending (oldest first):</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(bmi, <span class="dv">25</span>, <span class="dv">26</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(numAge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,453 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 40-55 Y     Y     N       White N     M          44    26   233   193
 2 HHUID0… 40-55 N     N     N       White N     M          44    25   180   130
 3 HHUID0… 40-55 Y     N     N       White N     F          44    25   158   180
 4 HHUID0… 40-55 Y     Y     N       White N     F          44    25   242   183
 5 HHUID0… 40-55 N     N     N       White N     F          44    25   195   121
 6 HHUID0… 40-55 N     N     N       White N     F          44    25   155   112
 7 HHUID0… 40-55 Y     Y     N       Asia… N     F          44    25   234   181
 8 HHUID0… 40-55 N     N     N       White Y     M          44    25   180   114
 9 HHUID0… 40-55 N     N     N       White N     M          44    25   157   126
10 HHUID0… 40-55 N     N     N       White Y     M          44    25   242   128
# … with 4,443 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort by multiple columns:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(numAge, <span class="fu">desc</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59,874 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 0-20  N     N     N       White N     M          19    36   180   111
 2 HHUID0… 0-20  N     N     N       White Y     M          19    36   155   119
 3 HHUID0… 0-20  N     N     N       White N     F          19    36   242   119
 4 HHUID0… 0-20  N     N     N       White N     M          19    36   158   134
 5 HHUID0… 0-20  N     N     N       White N     M          19    36   155   121
 6 HHUID0… 0-20  N     N     N       White Y     M          19    36   157   126
 7 HHUID0… 0-20  N     N     Y       Blac… N     F          19    35   158   117
 8 HHUID0… 0-20  N     N     N       White N     M          19    35   171   123
 9 HHUID0… 0-20  N     N     N       White Y     F          19    35   225    97
10 HHUID0… 0-20  N     N     N       White Y     M          19    35   186   113
# … with 59,864 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1">Exercise 1</h2>
<ol type="1">
<li>Using <code>filter()</code>, get patients aged 30+ whose systolic blood pressure is greater than 135. Store this set as an object called <code>high_bp</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>high_bp <span class="ot">&lt;-</span> cvdrisk <span class="sc">%&gt;%</span> <span class="fu">filter</span>(numAge <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">&amp;</span> sbp <span class="sc">&gt;</span> <span class="dv">135</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Sort <code>high_bp</code> according to numeric age and systolic blood pressure.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>high_bp <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(numAge, sbp) <span class="sc">%&gt;%</span> <span class="fu">View</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Why doesn’t the code below work? Can you fix it?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, htn, treat, smoking, race, t2d, gender, bmi) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(t2d <span class="sc">==</span> <span class="st">"Y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(numAge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutate-creating-new-columns" class="level2">
<h2 class="anchored" data-anchor-id="mutate-creating-new-columns"><code>mutate()</code>: Creating new columns</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/dplyr_mutate.png" class="img-fluid figure-img" alt="Cartoon of cute fuzzy monsters dressed up as different X-men characters, working together to add a new column to an existing data frame. Stylized title text reads “dplyr::mutate - add columns, keep existing.”"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
<p>Example using the <code>smartpill</code> dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(smartpill)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   95 obs. of  22 variables:
 $ Group                  : num  0 0 0 0 0 0 0 0 1 1 ...
 $ Gender                 : num  1 1 1 1 0 1 1 0 1 0 ...
 $ Race                   : num  NA NA NA NA NA NA NA NA 1 1 ...
 $ Height                 : num  183 180 180 175 152 ...
 $ Weight                 : num  102.1 102.1 68 69.9 44.9 ...
 $ Age                    : num  25 39 44 53 57 43 38 23 21 24 ...
 $ GE.Time                : num  74.3 73.3 4.3 NA 13.9 23.3 7.5 5.6 2.73 5.02 ...
 $ SB.Time                : num  8.4 13.8 6.7 NA 5.1 8.7 3.7 3.4 5.12 3.3 ...
 $ C.Time                 : num  NA NA NA NA NA ...
 $ WG.Time                : num  816 168 240 216 120 ...
 $ S.Contractions         : num  NA NA NA NA NA NA NA NA 145 114 ...
 $ S.Sum.of.Amplitudes    : num  NA NA NA NA NA ...
 $ S.Mean.Peak.Amplitude  : num  NA NA NA NA NA ...
 $ S.Mean.pH              : num  NA NA NA NA NA NA NA NA 2.07 2.28 ...
 $ SB.Contractions        : num  NA NA NA NA NA NA NA NA 298 782 ...
 $ SB.Sum.of.Amplitudes   : num  NA NA NA NA NA ...
 $ SB.Mean.Peak.Amplitude : num  NA NA NA NA NA ...
 $ SB.Mean.pH             : num  NA NA NA NA NA NA NA NA 7.26 7.21 ...
 $ Colon.Contractions     : num  NA NA NA NA NA NA NA NA 507 50 ...
 $ Colon.Sum.of.Amplitudes: num  NA NA NA NA NA ...
 $ C.Mean.Peak.Amplitude  : num  NA NA NA NA NA ...
 $ C.Mean.pH              : num  NA NA NA NA NA NA NA NA 7.58 7.21 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>smartpill <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> Height <span class="sc">/</span> Weight<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Group Gender Race  Height    Weight Age        BMI
1      0      1   NA 182.880 102.05820  25 0.01755781
2      0      1   NA 180.340 102.05820  39 0.01731395
3      0      1   NA 180.340  68.03880  44 0.03895640
4      0      1   NA 175.260  69.85317  53 0.03591787
5      0      0   NA 152.400  44.90561  57 0.07557598
6      0      1   NA 185.420  94.80073  43 0.02063162
7      0      1   NA 187.960  86.18248  38 0.02530623
8      0      0   NA 165.100  76.20346  23 0.02843137
9      1      1    1 172.720  74.38909  21 0.03121218
10     1      0    1 170.180  64.86366  24 0.04044880
11     1      1    3 180.340  58.96696  24 0.05186502
12     1      0    1 160.020  72.57472  28 0.03038110
13     1      1    1 180.340  81.64656  23 0.02705305
14     1      0    1 161.290  58.96696  32 0.04638632
15     1      1    3 180.340  69.39958  22 0.03744367
16     1      1    3 175.260  77.11064  22 0.02947503
17     1      1    1 175.260  77.11064  56 0.02947503
18     1      1    2 182.880  87.54326  38 0.02386277
19     1      0    1 167.640  77.11064  37 0.02819350
20     1      1    4 172.720  77.11064  40 0.02904785
21     1      0    2 154.940  79.37860  50 0.02458990
22     1      1    2 180.340  83.91452  38 0.02561049
23     1      0    2 175.260  69.85317  18 0.03591787
24     1      0    1 160.020  61.68851  19 0.04204997
25     1      1    1 182.880  74.84268  28 0.03264882
26     1      1    3 175.260  77.56423  31 0.02913130
27     1      0    4 162.560  59.87414  38 0.04534559
28     1      1    1 170.180  87.54326  50 0.02220563
29     1      1    2 175.260  86.18248  44 0.02359635
30     1      1    4 162.560  60.78133  57 0.04400209
31     1      1    2 162.560  74.84268  41 0.02902118
32     1      0    1 167.640  72.57472  50 0.03182782
33     1      0    1 175.260  79.37860  37 0.02781480
34     1      1    1 162.560  70.76035  37 0.03246637
35     1      1    1 177.800  68.03880  23 0.03840771
36     1      1    1 177.800  97.52228  40 0.01869494
37     1      0    1 177.800  72.57472  34 0.03375678
38     1      0    1 172.720  74.84268  64 0.03083500
39     1      1    1 167.640  96.16150  26 0.01812905
40     1      1    1 165.100  59.87414  25 0.04605411
41     1      1    1 175.260  74.84268  48 0.03128846
42     1      1    1 182.880  95.25432  30 0.02015565
43     1      0    1 177.800  61.23492  42 0.04741693
44     1      0    2 162.560 108.86208  34 0.01371704
45     1      0    1 165.100  54.43104  25 0.05572548
46     1      1    1 182.880  68.03880  25 0.03950508
47     1      0    2 172.720  68.03880  30 0.03731035
48     1      1    1 162.560  85.27530  31 0.02235462
49     1      0    1 193.040 101.15102  28 0.01886717
50     1      0    1 157.480  77.11064  44 0.02648481
51     1      1    1 162.560  68.03880  48 0.03511562
52     1      0    1 175.260  75.29627  40 0.03091262
53     1      1    1 175.260  65.77084  43 0.04051502
54     1      1    1 172.720  71.66754  42 0.03362774
55     1      1    1 193.040 111.13004  53 0.01563091
56     1      0    1 165.100 111.13004  34 0.01336854
57     1      1    2 180.340  72.57472  26 0.03423902
58     1      1    2 165.100  81.64656  29 0.02476688
59     1      1    1 182.880  90.71840  40 0.02222161
60     1      0    1 157.480  95.25432  52 0.01735626
61     1      0    1 157.480  51.70949  66 0.05889588
62     1      1    1 177.800  74.84268  20 0.03174191
63     1      1    1 191.770 127.00576  43 0.01188869
64     1      1    1 182.880  81.64656  55 0.02743408
65     1      1    1 179.070 114.30518  72 0.01370538
66     1      0    1 160.020  66.22443  52 0.03648697
67     1      1    1 180.340  87.54326  20 0.02353134
68     1      1    3 175.260  72.57472  29 0.03327454
69     1      0    1 152.400  53.97745  25 0.05230706
70     1      0    1 167.640  68.03880  38 0.03621299
71     1      1    1 175.260  97.52228  33 0.01842787
72     1      0    1 170.180  74.84268  29 0.03038155
73     1      0    1 167.640  57.60618  30 0.05051722
74     1      0    1 165.100  67.13162  44 0.03663472
75     1      0    1 162.560  65.99764  46 0.03732131
76     1      0    1 172.720  78.47142  51 0.02804915
77     1      0    1 169.672  58.46801  30 0.04963335
78     1      1    1 190.500 106.95699  34 0.01665239
79     1      0    1 157.480  64.68222  57 0.03764052
80     1      1    1 179.070  64.63686  26 0.04286100
81     1      1    1 180.340  68.26560  26 0.03869798
82     1      0    1 181.864  97.15941  30 0.01926536
83     1      0    1 165.100  77.11064  61 0.02776633
84     1      1    1 187.960 108.86208  49 0.01586033
85     1      1    1 179.070 102.73859  59 0.01696507
86     1      1    3 145.542  77.06528  35 0.02450591
87     1      0    1 132.080  56.24541  55 0.04175062
88     1      1    2 179.070  82.00943  29 0.02662534
89     1      1    4 180.340  77.20136  33 0.03025814
90     1      1    2 175.260  83.46093  44 0.02516033
91     1      0    5 163.830  57.96906  38 0.04875296
92     1      1    1 187.960  90.71840  28 0.02283887
93     1      0    1 171.450  61.59779  21 0.04518634
94     1      0    1 154.940  58.69480  43 0.04497428
95     1      0    1 162.560  59.78343  27 0.04548331</code></pre>
</div>
</div>
</section>
<section id="grouping-and-summarizing" class="level2">
<h2 class="anchored" data-anchor-id="grouping-and-summarizing">Grouping and summarizing</h2>
<p>Often, our observations can be arranged into interesting <em>groups</em>, typically based on a categorical variable (e.g., gender, race, age group, treatment). Our next step is usually to <em>summarize</em> those groups: how many observations in each group? What are the median and mean values, standard deviation, etc.?</p>
<p>Available summarizing functions:</p>
<ul>
<li><code>n()</code>, <code>n_distinct()</code></li>
<li><code>mean()</code>, <code>median()</code>, <code>sum()</code></li>
<li><code>quantile()</code>, <code>min()</code>, <code>max()</code>, <code>IQR()</code>, <code>sd()</code>, <code>var()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(smoking) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">n</span>(), <span class="fu">mean</span>(numAge), <span class="fu">mean</span>(bmi), <span class="fu">mean</span>(sbp), <span class="fu">mean</span>(tchol))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  smoking `n()` `mean(numAge)` `mean(bmi)` `mean(sbp)` `mean(tchol)`
  &lt;chr&gt;   &lt;int&gt;          &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;
1 N       52992           32.1        22.1        129.          187.
2 Y        6882           32.1        21.9        136.          189.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pause here for students to try</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or to apply the same summary function across() columns:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(smoking) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">n</span>(), <span class="fu">across</span>(<span class="fu">c</span>(numAge, bmi, sbp, tchol), mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  smoking `n()` numAge   bmi   sbp tchol
  &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 N       52992   32.1  22.1  129.  187.
2 Y        6882   32.1  21.9  136.  189.</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/dplyr_across.png" class="img-fluid figure-img" alt="A cute round fuzzy monster with fairy wings and a wand, with a party hat on reading “mean”, bouncing across the top of a data table applying the function to each column. Stylized text reads: “dplyr::across() - use within mutate() or summarize() to apply function(s) to a selection of columns!” An example shows the use within summarize: summarize(across(where(is.numeric), mean))."></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
</section>
<section id="slice_sample-random-sampling-of-rows" class="level2">
<h2 class="anchored" data-anchor-id="slice_sample-random-sampling-of-rows"><code>slice_sample()</code>: Random sampling of rows</h2>
<p>meaning of “slice”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cvdrisk <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11,974 × 17
   patie…¹ age   htn   treat smoking race  t2d   gender numAge   bmi tchol   sbp
   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 HHUID0… 20-40 N     N     N       Asia… Y     F          30    36   209   116
 2 HHUID0… 20-40 N     N     N       White N     F          34    31   160   138
 3 HHUID0… 40-55 N     N     N       White N     F          44    16   182   121
 4 HHUID0… 20-40 N     N     N       Asia… N     F          38    25   186   114
 5 HHUID0… 20-40 N     N     N       Asia… N     F          24    29   170   120
 6 HHUID0… 40-55 N     N     N       Asia… N     M          41    20   168   126
 7 HHUID0… 20-40 N     N     N       White Y     M          29    36   237   116
 8 HHUID0… 20-40 N     N     N       White N     M          34    25   177   112
 9 HHUID0… 20-40 N     N     N       White N     F          38    23   175    98
10 HHUID0… 20-40 N     N     N       White Y     F          30    22   242   123
# … with 11,964 more rows, 5 more variables: rs10757278 &lt;chr&gt;, rs1333049 &lt;chr&gt;,
#   rs4665058 &lt;chr&gt;, rs8055236 &lt;chr&gt;, cvd &lt;chr&gt;, and abbreviated variable name
#   ¹​patientID
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
</section>
<section id="data-cleaning-tidy-data-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-tidy-data-missing-values">Data cleaning: tidy data, missing values</h2>
<p>When a dataset doesn’t have one observation per row and/or one variable per column, we need to <strong>reshape</strong> it using <code>{tidyr}</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/tidydata_1.jpg" class="img-fluid figure-img" alt="Stylized text providing an overview of Tidy Data. The top reads “Tidy data is a standard way of mapping the meaning of a dataset to its structure. - Hadley Wickham.” On the left reads “In tidy data: each variable forms a column; each observation forms a row; each cell is a single measurement.” There is an example table on the lower right with columns ‘id’, ‘name’ and ‘color’ with observations for different cats, illustrating tidy data structure."></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Artwork by @allison_horst</figcaption><p></p>
</figure>
</div>
<p>In <code>table2</code>, one column shows <code>type</code> (of measurement), either “cases” or “population.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(table2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use the information in <code>type</code> to make two new columns, <code>cases</code> and <code>population</code>, which hold the value of <code>count</code>. We do this with <code>pivot_wider()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>type, <span class="at">values_from=</span>count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
<p>In contrast, <code>table4a</code> has a column for each year; we would like to move year information into its own column, and reduce the overall number of columns to make the table “longer”—<code>pivot_longer()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  country     `1999` `2000`
* &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
1 Afghanistan    745   2666
2 Brazil       37737  80488
3 China       212258 213766</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>table4a <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">`</span><span class="at">1999</span><span class="st">`</span>, <span class="st">`</span><span class="at">2000</span><span class="st">`</span>), <span class="at">names_to=</span><span class="st">"year"</span>, <span class="at">values_to=</span><span class="st">"cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country     year   cases
  &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
1 Afghanistan 1999     745
2 Afghanistan 2000    2666
3 Brazil      1999   37737
4 Brazil      2000   80488
5 China       1999  212258
6 China       2000  213766</code></pre>
</div>
</div>
</section>
<section id="exporting-data-from-r" class="level2">
<h2 class="anchored" data-anchor-id="exporting-data-from-r">Exporting data from R</h2>
<section id="saving-as-csv-readr" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-csv-readr">Saving as CSV (readr)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(high_bp, <span class="st">"high-bp.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-as-xlsx" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-xlsx">Saving as XLSX</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(high_bp, <span class="st">"high-bp.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="saving-as-rds-and-rdata" class="level3">
<h3 class="anchored" data-anchor-id="saving-as-rds-and-rdata">Saving as RDS and RData</h3>
<p>.RDS and .RData are two file formats specific to R.</p>
<ul>
<li><strong>RDS</strong>, “R data structure” (I think), is for saving an R <em>object</em> (e.g., data frame) to disk. This file will be smaller than a CSV or XLSX and faster to load/save in R. This makes it a good choice for saving a dataset you’re working on.</li>
<li><strong>RData</strong> is for saving your R <em>session</em> (Environment pane) to disk. Upon starting a session, this can be a faster way to restore your workspace than running your entire notebook again.</li>
</ul>
<p>To save an object as RDS:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(cvdrisk, <span class="st">"data/cvdrisk.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To load an RDS file into an R object:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>loaded_cvdrisk <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/cvdrisk.RDS"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># what does this loaded RDS look like?</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(loaded_cvdrisk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spec_tbl_df [59,874 × 17] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ patientID : chr [1:59874] "HHUID00520605" "HHUID00576813" "HHUID00957042" "HHUID00226899" ...
 $ age       : chr [1:59874] "20-40" "20-40" "40-55" "20-40" ...
 $ htn       : chr [1:59874] "N" "N" "Y" "Y" ...
 $ treat     : chr [1:59874] "N" "N" "N" "Y" ...
 $ smoking   : chr [1:59874] "N" "N" "N" "N" ...
 $ race      : chr [1:59874] "White" "White" "White" "White" ...
 $ t2d       : chr [1:59874] "N" "N" "N" "N" ...
 $ gender    : chr [1:59874] "F" "F" "F" "F" ...
 $ numAge    : num [1:59874] 37 32 40 32 29 40 43 20 37 24 ...
 $ bmi       : num [1:59874] 22 25 23 23 17 25 25 17 21 23 ...
 $ tchol     : num [1:59874] 175 156 243 157 156 193 196 238 195 240 ...
 $ sbp       : num [1:59874] 113 116 193 183 131 164 120 188 113 125 ...
 $ rs10757278: chr [1:59874] "AA" "AA" "AA" "AA" ...
 $ rs1333049 : chr [1:59874] "CC" "CC" "CC" "CC" ...
 $ rs4665058 : chr [1:59874] "CC" "CC" "AA" "CC" ...
 $ rs8055236 : chr [1:59874] "TT" "TT" "TT" "GG" ...
 $ cvd       : chr [1:59874] "N" "N" "N" "N" ...
 - attr(*, "spec")=
  .. cols(
  ..   patientID = col_character(),
  ..   age = col_character(),
  ..   htn = col_character(),
  ..   treat = col_character(),
  ..   smoking = col_character(),
  ..   race = col_character(),
  ..   t2d = col_character(),
  ..   gender = col_character(),
  ..   numAge = col_double(),
  ..   bmi = col_double(),
  ..   tchol = col_double(),
  ..   sbp = col_double(),
  ..   rs10757278 = col_character(),
  ..   rs1333049 = col_character(),
  ..   rs4665058 = col_character(),
  ..   rs8055236 = col_character(),
  ..   cvd = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>To work with .RData files, the easiest way is to use the load/save icons at top left of the Environment pane .</p>
<p>There is also an RStudio save-on-exit feature which preserves your session (as a .RData), so that next time you open RStudio, you can pick up where you left off. This is convenient, but requires diligent notebook accounting.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/config-rdata.png" class="img-fluid figure-img" alt="Cropped screenshot of RStudio's global option. The selection is titled Workspace. There is a checkbox labeled &quot;Restore .RData into workspace at startup&quot;. The box is unchecked. There is a drop-down menu reading &quot;Save workspace to .RData on exit:&quot;. The option &quot;Never&quot; is selected."></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Tools &gt; Global Options… &gt; General</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<ul>
<li>Problem Set 2</li>
<li>Next time: data visualization!</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>